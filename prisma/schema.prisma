generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// ============================================
// ABOUT / PROFILE
// ============================================
model Profile {
  id        String   @id @default(cuid())
  name      String
  title     String
  bio       String   @db.Text
  avatarUrl String?
  resumeUrl String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  socialLinks SocialLink[]
}

model SocialLink {
  id        String   @id @default(cuid())
  platform  String
  url       String
  order     Int      @default(0)
  profileId String
  profile   Profile  @relation(fields: [profileId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([profileId])
}

// ============================================
// PROJECTS
// ============================================
model Project {
  id           String   @id @default(cuid())
  title        String
  slug         String   @unique
  description  String   @db.Text
  thumbnailUrl String?
  liveUrl      String?
  githubUrl    String?
  featured     Boolean  @default(false)
  order        Int      @default(0)
  published    Boolean  @default(false)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  techStack ProjectTech[]
}

model Tech {
  id       String        @id @default(cuid())
  name     String        @unique
  iconUrl  String?
  projects ProjectTech[]
}

model ProjectTech {
  projectId String
  techId    String
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  tech      Tech    @relation(fields: [techId], references: [id], onDelete: Cascade)

  @@id([projectId, techId])
  @@index([projectId])
  @@index([techId])
}

// ============================================
// BLOG (Markdown content)
// ============================================
model Post {
  id          String    @id @default(cuid())
  title       String
  slug        String    @unique
  excerpt     String    @db.Text
  content     String    @db.Text
  coverUrl    String?
  readingTime Int       @default(5)
  published   Boolean   @default(false)
  publishedAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  tags PostTag[]
}

model Tag {
  id    String    @id @default(cuid())
  name  String    @unique
  slug  String    @unique
  posts PostTag[]
}

model PostTag {
  postId String
  tagId  String
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)
  tag    Tag    @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([postId, tagId])
  @@index([postId])
  @@index([tagId])
}

// ============================================
// EXPERIENCE
// ============================================
model Experience {
  id          String    @id @default(cuid())
  company     String
  role        String
  description String?   @db.Text
  logoUrl     String?
  startDate   DateTime
  endDate     DateTime?
  current     Boolean   @default(false)
  order       Int       @default(0)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

// ============================================
// SKILLS
// ============================================
model Skill {
  id        String   @id @default(cuid())
  name      String
  category  String
  iconUrl   String?
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([name, category])
}
